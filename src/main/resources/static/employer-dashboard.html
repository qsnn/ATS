<!-- language: html -->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¼ä¸šç®¡ç†å‘˜ä¸­å¿ƒ - æ‹›è˜ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/dashboard.css">
</head>
<body>
<!-- é¡¶éƒ¨å¯¼èˆª -->
<nav class="navbar">
    <div class="container nav-content">
        <div class="nav-logo">
            <a href="index.html" class="btn btn-sm" style="margin-right: 15px;">è¿”å›é¦–é¡µ</a>
            <h1>æ‹›è˜ç³»ç»Ÿ - ä¼ä¸šç®¡ç†å‘˜</h1>
        </div>
        <div class="nav-user">
            <span id="user-greeting">æ¬¢è¿ï¼Œä¼ä¸šç®¡ç†å‘˜</span>
            <button class="btn logout-btn" onclick="handleLogout()">é€€å‡º</button>
        </div>
    </div>
</nav>

<div class="container">
    <!-- æ ‡ç­¾é¡µ -->
    <div class="dashboard-tabs">
        <button class="tab-btn active" onclick="switchTab('manage')">èŒä½ç®¡ç†</button>
        <button class="tab-btn" onclick="switchTab('post')">å‘å¸ƒèŒä½</button>
        <button class="tab-btn" onclick="switchTab('applicants')">ç”³è¯·äººç®¡ç†</button>
        <button class="tab-btn" onclick="switchTab('talent')">äººæ‰åº“</button>
        <button class="tab-btn" onclick="switchTab('company')">å…¬å¸ä¿¡æ¯</button>
    </div>
    <!-- å…¬å¸ä¿¡æ¯ï¼ˆå ä½ï¼‰ -->
    <div id="company-tab" class="tab-content">
        <h2>å…¬å¸ä¿¡æ¯</h2>
        <div class="card">
            <p>è¿™é‡Œå¯ä»¥å±•ç¤ºå’Œç¼–è¾‘å…¬å¸åŸºç¡€ä¿¡æ¯ï¼ˆæ¼”ç¤ºå ä½ï¼‰ã€‚</p>
        </div>
    </div>

    <!-- èŒä½ç®¡ç† -->
    <div id="manage-tab" class="tab-content active">
        <h2>å‘å¸ƒçš„èŒä½</h2>
        <div class="card">
            <table class="data-table">
                <thead>
                <tr>
                    <th>èŒä½åç§°</th>
                    <th>è–ªèµ„èŒƒå›´</th>
                    <th>å·¥ä½œåœ°ç‚¹</th>
                    <th>ç”³è¯·äººæ•°</th>
                    <th>å‘å¸ƒæ—¶é—´</th>
                    <th>æ“ä½œ</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ</td>
                    <td>Â¥20K-35K</td>
                    <td>åŒ—äº¬</td>
                    <td>15</td>
                    <td>2024-01-15</td>
                    <td>
                        <button class="btn btn-primary btn-sm">æŸ¥çœ‹ç”³è¯·äºº</button>
                        <button class="btn btn-danger btn-sm">åˆ é™¤</button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>



    <!-- å‘å¸ƒèŒä½ -->
    <div id="post-tab" class="tab-content">
        <h2>å‘å¸ƒæ–°èŒä½</h2>
        <div class="card">
            <form id="post-job-form">
                <div class="form-row">
                    <div class="form-group">
                        <label>èŒä½åç§° \*</label>
                        <input type="text" required>
                    </div>
                    <div class="form-group">
                        <label>è–ªèµ„èŒƒå›´ \*</label>
                        <input type="text" placeholder="å¦‚ï¼šÂ¥20K-35K" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>å·¥ä½œåœ°ç‚¹ \*</label>
                        <input type="text" required>
                    </div>
                    <div class="form-group">
                        <label>å·¥ä½œç»éªŒè¦æ±‚</label>
                        <input type="text" placeholder="å¦‚ï¼š3-5å¹´">
                    </div>
                </div>

                <div class="form-group">
                    <label>èŒä½æè¿° \*</label>
                    <textarea rows="6" required></textarea>
                </div>

                <div class="form-group">
                    <label>èŒä½è¦æ±‚</label>
                    <textarea rows="4"></textarea>
                </div>

                <button type="submit" class="btn btn-primary">å‘å¸ƒèŒä½</button>
            </form>
        </div>
    </div>

    <!-- ç”³è¯·äººç®¡ç† -->
    <div id="applicants-tab" class="tab-content">
        <h2>èŒä½ç”³è¯·äºº</h2>
        <div class="card">
            <div class="applicant-list">
                <div class="applicant-item">
                    <div class="applicant-info">
                        <h4>å¼ ä¸‰</h4>
                        <p>ç”³è¯·èŒä½ï¼šå‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ</p>
                        <p>ç”³è¯·æ—¶é—´ï¼š2024-01-16</p>
                    </div>
                    <div class="applicant-actions">
                        <button class="btn btn-primary" onclick="viewResume(1)">æŸ¥çœ‹ç®€å†</button>
                        <button class="btn btn-success" onclick="setApplicantStatus(1, 'interview')">å®‰æ’é¢è¯•</button>
                        <button class="btn" onclick="addToTalentPoolFromApplicant(1)">åŠ å…¥äººæ‰åº“</button>
                        <button class="btn btn-danger" onclick="rejectApplicant(1)">æ‹’ç»</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- äººæ‰åº“ -->
    <div id="talent-tab" class="tab-content">
        <div class="flex items-center justify-between mb-4">
            <h2>äººæ‰åº“ç®¡ç†</h2>
            <div class="flex gap-2">
                <select id="talent-filter" onchange="filterTalent()">
                    <option value="">å…¨éƒ¨äººæ‰</option>
                    <option value="web">Webå¼€å‘</option>
                    <option value="java">Javaå¼€å‘</option>
                    <option value="ui">UIè®¾è®¡</option>
                    <option value="product">äº§å“ç»ç†</option>
                </select>
                <input type="text" placeholder="æœç´¢äººæ‰..." oninput="searchTalent()">
            </div>
        </div>

        <div class="talent-stats mb-4">
            <div class="card" style="padding: 15px;">
                <div class="flex justify-between">
                    <div>
                        <strong>äººæ‰åº“ç»Ÿè®¡</strong>
                        <p style="margin: 5px 0 0 0; font-size: 12px; color: #666;">
                            å…± <span id="total-talents">0</span> äºº |
                            æœ€è¿‘æ·»åŠ ï¼š<span id="recent-added">0</span> äºº
                        </p>
                    </div>
                    <button class="btn btn-sm" onclick="exportTalent()">å¯¼å‡ºäººæ‰åº“</button>
                </div>
            </div>
        </div>

        <div class="talent-list">
            <div class="empty-state" id="talent-empty-state">
                <div class="icon">ğŸ“š</div>
                <p>äººæ‰åº“ä¸ºç©º</p>
                <p style="font-size: 12px; margin-top: 8px;">è¿™é‡Œä¼šä¿å­˜æœªå½•å–çš„ä¼˜ç§€å€™é€‰äººï¼Œæ–¹ä¾¿åç»­è”ç³»</p>
            </div>
        </div>
    </div>



</div>

<script src="js/auth.js"></script>
<script>
    // æ ‡ç­¾é¡µåˆ‡æ¢ï¼ˆåŒ admin é¡µï¼‰
    function switchTab(tabName) {
        document.querySelectorAll('.tab-content').forEach(tab => {
            tab.classList.remove('active');
        });
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        document.getElementById(tabName + '-tab').classList.add('active');
        event.target.classList.add('active');
    }

    // ä»ç”³è¯·äººæ·»åŠ åˆ°äººæ‰åº“
    function addToTalentPoolFromApplicant(applicantId) {
        const note = prompt('è¯·è¾“å…¥å¤‡æ³¨ï¼ˆä¸ºä»€ä¹ˆåŠ å…¥äººæ‰åº“ï¼‰ï¼š', 'æŠ€æœ¯èƒ½åŠ›ä¼˜ç§€ï¼Œæš‚æ—¶æ²¡æœ‰åˆé€‚èŒä½');
        if (note === null) return;

        const applicantInfo = {
            name: `ç”³è¯·äºº${applicantId}`,
            position: 'Javaå¼€å‘å·¥ç¨‹å¸ˆ',
            experience: '3-5å¹´',
            education: 'æœ¬ç§‘',
            skills: ['Java', 'Spring', 'MySQL'],
            phone: '138****5678',
            email: `applicant${applicantId}@email.com`,
            source: 'ç”³è¯·äººè½¬åŒ–',
            sourceJob: 'Javaå¼€å‘å·¥ç¨‹å¸ˆ',
            note: note
        };

        const result = MockData.addToTalentPool(applicantInfo);
        if (result.success) {
            alert('ç”³è¯·äººå·²æ·»åŠ åˆ°äººæ‰åº“');
        }
    }

    function rejectApplicant(applicantId) {
        if (confirm('æ‹’ç»è¯¥ç”³è¯·äººï¼Ÿ')) {
            alert(`ç”³è¯·äºº ${applicantId} å·²è¢«æ‹’ç»`);
        }
    }

    // äººæ‰åº“æ¸²æŸ“
    function renderTalentPool() {
        const talentList = document.querySelector('.talent-list');
        if (!talentList) return;

        if (!window.MockData || !MockData.talentPool || MockData.talentPool.length === 0) {
            document.getElementById('talent-empty-state').style.display = 'block';
            document.getElementById('total-talents').textContent = '0';
            document.getElementById('recent-added').textContent = '0';
            return;
        }

        document.getElementById('talent-empty-state').style.display = 'none';
        document.getElementById('total-talents').textContent = MockData.talentPool.length;

        const thirtyDaysAgo = new Date();
        thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
        const recentCount = MockData.talentPool.filter(talent => {
            const addedDate = new Date(talent.addedDate);
            return addedDate >= thirtyDaysAgo;
        }).length;
        document.getElementById('recent-added').textContent = recentCount;

        talentList.innerHTML = MockData.talentPool.map(talent => `
            <div class="talent-card" data-talent-id="${talent.id}">
                <div class="talent-header">
                    <div>
                        <h3 class="talent-name">${talent.name}</h3>
                        <div style="font-size: 14px; color: #666; margin-top: 4px;">
                            ${talent.position} Â· ${talent.experience}ç»éªŒ Â· ${talent.education}
                        </div>
                    </div>
                    <span class="talent-source">${talent.source}</span>
                </div>

                <div class="talent-info">
                    <div class="talent-info-item">
                        <span>ğŸ“±</span>
                        <span>${talent.phone}</span>
                    </div>
                    <div class="talent-info-item">
                        <span>ğŸ“§</span>
                        <span>${talent.email}</span>
                    </div>
                    <div class="talent-info-item">
                        <span>ğŸ“…</span>
                        <span>æ·»åŠ æ—¶é—´ï¼š${talent.addedDate}</span>
                    </div>
                    ${talent.sourceJob ? `
                    <div class="talent-info-item">
                        <span>ğŸ’¼</span>
                        <span>æ¥æºèŒä½ï¼š${talent.sourceJob}</span>
                    </div>
                    ` : ''}
                </div>

                <div class="talent-tags">
                    ${talent.skills.map(skill => `<span class="talent-tag">${skill}</span>`).join('')}
                </div>

                ${talent.note ? `
                <div class="talent-note">
                    <strong>å¤‡æ³¨ï¼š</strong>
                    ${talent.note}
                </div>
                ` : ''}

                <div class="talent-actions">
                    <button class="btn btn-sm" onclick="viewTalentDetail(${talent.id})">æŸ¥çœ‹è¯¦æƒ…</button>
                    <button class="btn btn-primary btn-sm" onclick="inviteTalent(${talent.id})">é‚€è¯·é¢è¯•</button>
                    <button class="btn btn-danger btn-sm" onclick="removeTalent(${talent.id})">ç§»é™¤</button>
                </div>
            </div>
        `).join('');
    }

    function viewTalentDetail(talentId) {
        const talent = MockData.talentPool.find(t => t.id === talentId);
        if (!talent) {
            alert('æ‰¾ä¸åˆ°è¯¥äººæ‰ä¿¡æ¯');
            return;
        }

        const modalHTML = `
            <div class="talent-modal" id="talent-detail-modal">
                <div class="talent-modal-content">
                    <div class="talent-modal-header">
                        <h3 class="talent-modal-title">äººæ‰è¯¦æƒ…</h3>
                        <button class="close-modal" onclick="closeModal()">Ã—</button>
                    </div>

                    <div class="talent-detail">
                        <div style="margin-bottom: 20px;">
                            <h4 style="margin-bottom: 10px;">${talent.name} - ${talent.position}</h4>
                            <div style="color: #666; font-size: 14px;">
                                ${talent.experience}ç»éªŒ Â· ${talent.education}
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                            <div>
                                <strong>è”ç³»æ–¹å¼</strong>
                                <p>ğŸ“± ${talent.phone}</p>
                                <p>ğŸ“§ ${talent.email}</p>
                            </div>
                            <div>
                                <strong>äººæ‰æ¥æº</strong>
                                <p>æ¥æºï¼š${talent.source}</p>
                                <p>æ·»åŠ æ—¶é—´ï¼š${talent.addedDate}</p>
                                ${talent.sourceJob ? `<p>æ¥æºèŒä½ï¼š${talent.sourceJob}</p>` : ''}
                            </div>
                        </div>

                        <div style="margin-bottom: 20px;">
                            <strong>æŠ€èƒ½æ ‡ç­¾</strong>
                            <div class="talent-tags" style="margin-top: 10px;">
                                ${talent.skills.map(skill => `<span class="talent-tag">${skill}</span>`).join('')}
                            </div>
                        </div>

                        ${talent.note ? `
                        <div style="margin-bottom: 20px;">
                            <strong>å¤‡æ³¨</strong>
                            <p style="margin-top: 10px; padding: 10px; background: #f5f5f5; border-radius: 4px;">
                                ${talent.note}
                            </p>
                        </div>
                        ` : ''}
                    </div>

                    <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                        <button class="btn" onclick="closeModal()">å…³é—­</button>
                        <button class="btn btn-primary" onclick="inviteTalent(${talent.id})">é‚€è¯·é¢è¯•</button>
                    </div>
                </div>
            </div>
        `;
        document.body.insertAdjacentHTML('beforeend', modalHTML);
        document.getElementById('talent-detail-modal').style.display = 'flex';
    }

    function inviteTalent(talentId) {
        const jobTitle = prompt('è¯·è¾“å…¥è¦é‚€è¯·çš„èŒä½åç§°ï¼š', 'å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ');
        if (!jobTitle) return;

        const interviewTime = prompt('è¯·è¾“å…¥å»ºè®®çš„é¢è¯•æ—¶é—´ï¼ˆYYYY-MM-DD HH:MMï¼‰ï¼š', '2024-01-25 14:00');
        if (!interviewTime) return;

        alert(`å·²å‘äººæ‰å‘é€é¢è¯•é‚€è¯·\nèŒä½ï¼š${jobTitle}\næ—¶é—´ï¼š${interviewTime}\nï¼ˆæ¨¡æ‹Ÿæ“ä½œï¼‰`);
        closeModal();
    }

    function removeTalent(talentId) {
        if (confirm('ç¡®å®šè¦ä»äººæ‰åº“ä¸­ç§»é™¤è¯¥äººæ‰å—ï¼Ÿ')) {
            const result = MockData.removeFromTalentPool(talentId);
            if (result.success) {
                alert('äººæ‰å·²ä»äººæ‰åº“ç§»é™¤');
                renderTalentPool();
            } else {
                alert(result.message);
            }
        }
    }

    function filterTalent() {
        const filterValue = document.getElementById('talent-filter').value;
        alert(`ç­›é€‰äººæ‰ï¼š${filterValue || 'å…¨éƒ¨'}ï¼ˆæ¨¡æ‹Ÿæ“ä½œï¼‰`);
    }

    function searchTalent() {
        const searchTerm = document.querySelector('input[placeholder*="æœç´¢äººæ‰"]').value;
        if (searchTerm) {
            alert(`æœç´¢äººæ‰ï¼š${searchTerm}ï¼ˆæ¨¡æ‹Ÿæ“ä½œï¼‰`);
        }
    }

    function exportTalent() {
        alert('æ­£åœ¨å¯¼å‡ºäººæ‰åº“æ•°æ®...ï¼ˆæ¨¡æ‹Ÿæ“ä½œï¼‰');
        setTimeout(() => {
            alert('äººæ‰åº“æ•°æ®å·²å¯¼å‡ºä¸º talent_pool_export.csv');
        }, 1000);
    }

    function addApplicantToTalentPool(applicantId) {
        const note = prompt('è¯·è¾“å…¥å¤‡æ³¨ï¼ˆä¸ºä»€ä¹ˆåŠ å…¥äººæ‰åº“ï¼‰ï¼š', 'æŠ€æœ¯èƒ½åŠ›ä¼˜ç§€ï¼Œæš‚æ—¶æ²¡æœ‰åˆé€‚èŒä½');
        if (note === null) return;

        const newTalent = {
            name: `å€™é€‰äºº${applicantId}`,
            position: 'å¾…å®š',
            experience: '3å¹´',
            education: 'æœ¬ç§‘',
            skills: ['Java', 'Spring', 'MySQL'],
            phone: '138****0000',
            email: `candidate${applicantId}@email.com`,
            source: 'ç”³è¯·äººè½¬åŒ–',
            sourceJob: 'Javaå¼€å‘å·¥ç¨‹å¸ˆ',
            note: note
        };

        const result = MockData.addToTalentPool(newTalent);
        if (result.success) {
            alert('å·²æ·»åŠ åˆ°äººæ‰åº“');
            if (document.getElementById('talent-tab').classList.contains('active')) {
                renderTalentPool();
            }
        }
    }

    function closeModal() {
        const modal = document.getElementById('talent-detail-modal');
        if (modal) {
            modal.remove();
        }
    }

    function viewResume(applicantId) {
        alert(`æŸ¥çœ‹ç”³è¯·äºº${applicantId}çš„ç®€å†ï¼ˆæ¨¡æ‹Ÿæ“ä½œï¼‰`);
    }

    function setApplicantStatus(applicantId, status) {
        alert(`è®¾ç½®ç”³è¯·äºº${applicantId}çŠ¶æ€ä¸ºï¼š${status}ï¼ˆæ¨¡æ‹Ÿæ“ä½œï¼‰`);
    }


    // é¡µé¢åˆå§‹åŒ–ï¼šå¡«å……æ¬¢è¿è¯­ã€åˆå§‹åŒ–äººæ‰åº“
    document.addEventListener('DOMContentLoaded', function () {
        const currentUser = JSON.parse(localStorage.getItem('currentUser'));
        if (currentUser && document.getElementById('user-greeting')) {
            document.getElementById('user-greeting').textContent =
                'æ¬¢è¿ï¼Œ' + (currentUser.name || currentUser.username || 'ä¼ä¸šç®¡ç†å‘˜');
        }

        // åˆå§‹åŒ–äººæ‰åº“å±•ç¤º
        renderTalentPool();
    });
</script>
<script src="js/auth.js"></script>
<script>
    function handleLogout() {
        // æ¸…é™¤ç™»å½•ä¿¡æ¯
        Auth.logout();

        // å¯é€‰ï¼šæ¸…ç† Router çš„ returnTo ç­‰
        localStorage.removeItem('returnTo');

        // è·³è½¬åˆ°é¦–é¡µæˆ–ç™»å½•é¡µ
        window.location.href = 'index.html';
    }
</script>
</body>
</html>